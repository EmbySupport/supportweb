<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>HWA fails with RDP | Emby Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="HWA fails with RDP | Emby Documentation ">
    <meta name="generator" content="docfx 2.59.2.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/socialbar.css">
    <link rel="stylesheet" href="../styles/header.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,100italic,300italic,400italic" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.2.0/css/all.min.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    <meta property="docfx:uid" content="Hwa-Fails-with-RDP">
    
    <meta property="docfx:rel" content="../">
    
    <script type="text/javascript" src="../nav.js"></script>
    <script type="text/javascript" src="toc.js"></script>
  
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <div class="mb-socials-heading" style="height: 40px;">
        	<div class="mb-socials-heading-inner container">
        		<div class="mb-socials-heading-right">
        			<div class="mb-socials-list">
                          
        				<div class="mb-socials-item facebook">
        					<a class="mb-socials-item-link" target="_blank" href="https://facebook.com/embyapp"></a>
        					<div class="mb-socials-item-popup">
        						<span>Facebook</span>
        					</div>
        				</div><div class="mb-socials-item twitter">
        					<a class="mb-socials-item-link" target="_blank" href="https://twitter.com/embyapp"></a>
        					<div class="mb-socials-item-popup">
        						<span>Twitter</span>
        					</div>
        				</div>
        				<div class="mb-socials-item pinterest">
        					<a class="mb-socials-item-link" target="_blank" href="https://www.pinterest.com/emby0240/emby-news/"></a>
        					<div class="mb-socials-item-popup">
        						<span>Pinterest</span>
        					</div>
        				</div>
        				<div class="mb-socials-item tumblr">
        					<a class="mb-socials-item-link" target="_blank" href="https://embyapp.tumblr.com/"></a>
        					<div class="mb-socials-item-popup">
        						<span>Tumblr</span>
        					</div>
        				</div>
        				<div class="mb-socials-item github">
        					<a class="mb-socials-item-link" target="_blank" href="https://github.com/MediaBrowser"></a>
        					<div class="mb-socials-item-popup">
        						<span>GitHub</span>
        					</div>
        				</div><div class="mb-socials-item rss">
        					<a class="mb-socials-item-link" target="_blank" href="https://emby.media/blog.xml"></a>
        					<div class="mb-socials-item-popup">
        						<span>RSS</span>
        					</div>
        				</div>
                          
        			</div>
        		</div>
        	</div>
        </div>
        <div class="container">
        	<nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
        		  
        		  <a class="navbar-brand" href="../index.html">
        		    <img id="logo" class="svg" src="../images/logo.png" alt="">
        		  </a>
        		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
        			<span class="sr-only">Toggle navigation</span>
        			<span class="icon-bar"></span>
        			<span class="icon-bar"></span>
        			<span class="icon-bar"></span>
        		  </button>
        		<div class="collapse navbar-collapse" id="navbar">
        			
        			<ul class="nav level1 navbar-nav">
        			      <li class="nav-item">
        			          <a class="nav-link" href="https://emby.media/about.html" title="About">About</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="https://emby.media/blog.html" title="Blog">Blog</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="https://emby.media/download.html" title="Download">Download</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="https://emby.media/premiere.html" title="Emby Premiere">Emby Premiere</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="http://app.emby.media/" title="Sign In">Sign In</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="../index.html" title="Support">Support</a>
        			      </li>
        			</ul>		</div>
        	</nav>
        </div>
        <div class="nav-overlay d-none"></div>        
        <div class="subnav navbar navbar-default">
          <div class="container">
            <div class="hide-when-search" id="breadcrumb">
        	  <ul class="breadcrumb">
        		<li></li>
        	  </ul>
        	</div>
        
        	<div class="breadcrumpsearch">
        	  <form class="navbar-form navbar-right" role="search" id="search">
        		<div class="form-group">
        		  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
        		</div>
        	  </form>
        	</div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="Hwa-Fails-with-RDP">
<h1>HWA fails with RDP</h1>
<h4 class="long-title">Hardware Acceleration Fails with Remote Desktop (RDP) on Windows</h4>

<p>Product: Emby Server
Affected Platforms:	Windows 8.1, Windows 10, Windows Server 2016, Windows Server 2019
Affected Hardware:	Intel QuickSync, AMD AMF, DXVA2 and D3D11VA Codecs</p>
<h2 id="symptoms">Symptoms</h2>
<p>When you have configured Emby Server to use a hardware video acceleration method that is based on Microsoft Direct3D, you may experience erroneous behavior or total failure of hardware accelerated video processing, when you log in to the computer running Emby Server via MS Remote Desktop Connection, also known as RDP.</p>
<h2 id="solution">Solution</h2>
<p>To avoid this problem, you need to change the configuration of the RDP Session Host on the computer running Emby Server. This can to be done via a Windows Group Policy setting, by following these steps:</p>
<ol>
<li>Open the 'Local Group Policy Editor' via one of the following methods:</li>
</ol>
<ul>
<li>Open Windows Setting and type 'group' in the search box</li>
<li>Open Control Panel  and type 'group' in the search box</li>
<li>Start &gt; Run &gt; enter 'gpedit.msc' (without the quotes) and click 'OK'</li>
</ul>
<ol start="2">
<li>Navigate in the left tree</li>
</ol>
<ul>
<li>Computer Configuration</li>
<li>Administrative Templates</li>
<li>Windows Components</li>
<li>Remote Desktop Services</li>
<li>Remote Desktop Session Host</li>
<li>Remote Session Environment</li>
</ul>
<p>In the right pane, locate the entry highlighted below
('Use hardware graphics adapters for all Remote Desktop Services sessions')</p>
<p><img src="images/server/rdp_hwa.png" alt="Rdp Hwa"></p>
<ul>
<li>Right click the entry and select 'Edit'</li>
<li>In the dialog, change the policy setting to 'Disabled' and click 'OK'</li>
<li>Reboot the computer</li>
</ul>
<h2 id="background">Background</h2>
<p>In recent Windows versions, the RDP service can use video and graphic hardware acceleration for 2D and 3D composition of remote session desktops, in latest versions it can even use H.264 video instead of GDI instructions for delivering the desktop to the client.</p>
<p>When these RDP features are activated and a client connects via Remote Desktop, the RDP Session Host will block all D3D and DXGI for any other use than the local session.</p>
<p>Under these circumstances, and when Emby Server is running in a local session and this session is not the one being logged into via RDP, it can happen that D3D9 based hardware accelerations are still working (sometimes with flaws, though), because D3D9 is always related to a user session context.</p>
<p>Hardware acceleration based on D3D11 will never work in the described situation.</p>
<h3 id="affected-hardware-codecs">Affected Hardware Codecs</h3>
<h4 id="direct3d-9">Direct3D 9</h4>
<p>QuickSync Video Decoders
(without D3D11 in the name)
QuickSync Video Encoders
(without D3D11 in the name)
AMD AMF Encoders
DXVA2 Decoders</p>
<h4 id="direct3d-11">Direct3D 11</h4>
<p>QuickSync D3D11 Video Decoders
QuickSync D3D11 Video Encoders
D3D11VA Video Decoders</p>


            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://support.emby.media/support/solutions/articles/44001894172-hardware-acceleration-fails-with-remote-desktop-rdp-on-windows" class="contribution-link">On FreshDesk</a>
                  </li>
                  <li>
                    <a href="https://github.com/EmbySupport/Emby.Docs/blob/master/Hwa-Fails-with-RDP.md/#L1" class="contribution-link">View Source</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix sdkversion" id="affix">
                <h5>On this Page</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to Top</a>
            </span>
            2023 © EMBY LLC.  Please see our <a class="lnk" href="https://emby.media/terms.html">terms of use</a> and <a class="lnk" href="https://emby.media/privacy.html">privacy policy</a>.
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../searchIndex.js"></script>
    <script type="text/javascript" src="../styles/lunr.min.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
