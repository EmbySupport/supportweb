<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Emby Server does not start - Security advisory 2023-05-25 | Emby Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Emby Server does not start - Security advisory 2023-05-25 | Emby Documentation ">
    <meta name="generator" content="docfx 2.59.2.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/socialbar.css">
    <link rel="stylesheet" href="../styles/header.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,100italic,300italic,400italic" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.2.0/css/all.min.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    <meta property="docfx:uid" content="Emby-Server-does-not-start---Security-advisory-2023-05-25">
    
    <meta property="docfx:rel" content="../">
    
    <script type="text/javascript" src="../nav.js"></script>
    <script type="text/javascript" src="toc.js"></script>
  
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <div class="mb-socials-heading" style="height: 40px;">
        	<div class="mb-socials-heading-inner container">
        		<div class="mb-socials-heading-right">
        			<div class="mb-socials-list">
                          
        				<div class="mb-socials-item facebook">
        					<a class="mb-socials-item-link" target="_blank" href="https://facebook.com/embyapp"></a>
        					<div class="mb-socials-item-popup">
        						<span>Facebook</span>
        					</div>
        				</div><div class="mb-socials-item twitter">
        					<a class="mb-socials-item-link" target="_blank" href="https://twitter.com/embyapp"></a>
        					<div class="mb-socials-item-popup">
        						<span>Twitter</span>
        					</div>
        				</div>
        				<div class="mb-socials-item pinterest">
        					<a class="mb-socials-item-link" target="_blank" href="https://www.pinterest.com/emby0240/emby-news/"></a>
        					<div class="mb-socials-item-popup">
        						<span>Pinterest</span>
        					</div>
        				</div>
        				<div class="mb-socials-item tumblr">
        					<a class="mb-socials-item-link" target="_blank" href="https://embyapp.tumblr.com/"></a>
        					<div class="mb-socials-item-popup">
        						<span>Tumblr</span>
        					</div>
        				</div>
        				<div class="mb-socials-item github">
        					<a class="mb-socials-item-link" target="_blank" href="https://github.com/MediaBrowser"></a>
        					<div class="mb-socials-item-popup">
        						<span>GitHub</span>
        					</div>
        				</div><div class="mb-socials-item rss">
        					<a class="mb-socials-item-link" target="_blank" href="https://emby.media/blog.xml"></a>
        					<div class="mb-socials-item-popup">
        						<span>RSS</span>
        					</div>
        				</div>
                          
        			</div>
        		</div>
        	</div>
        </div>
        <div class="container">
        	<nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
        		  
        		  <a class="navbar-brand" href="/">
        		    <img id="logo" class="svg" src="../images/logo.png" alt="">
        		  </a>
        		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
        			<span class="sr-only">Toggle navigation</span>
        			<span class="icon-bar"></span>
        			<span class="icon-bar"></span>
        			<span class="icon-bar"></span>
        		  </button>
        		<div class="collapse navbar-collapse" id="navbar">
        			
        			<ul class="nav level1 navbar-nav">
        			      <li class="nav-item">
        			          <a class="nav-link" href="https://emby.media/about.html" title="About">About</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="https://emby.media/blog.html" title="Blog">Blog</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="https://emby.media/download.html" title="Download">Download</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="https://emby.media/premiere.html" title="Emby Premiere">Emby Premiere</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="http://app.emby.media/" title="Sign In">Sign In</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="../index.html" title="Support">Support</a>
        			      </li>
        			</ul>		</div>
        	</nav>
        </div>
        <div class="nav-overlay d-none"></div>        
        <div class="subnav navbar navbar-default">
          <div class="container">
            <div class="hide-when-search" id="breadcrumb">
        	  <ul class="breadcrumb">
        		<li></li>
        	  </ul>
        	</div>
        
        	<div class="breadcrumpsearch">
        	  <form class="navbar-form navbar-right" role="search" id="search">
        		<div class="form-group">
        		  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
        		</div>
        	  </form>
        	</div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="Emby-Server-does-not-start---Security-advisory-2023-05-25">
<h1>Emby Server does not start - Security advisory 2023-05-25</h1>


<h2 id="applicability">Applicability</h2>
<p>This article applies to cases where you are experiencing one or more of the following symptoms:</p>
<ul>
<li>Your Emby Server has shut itself down and/or does not start anymore since 2023-05-25</li>
<li>You encounter the following message in the Emby Server log:
<em>We have detected a malicious plugin on your system which has probably been installed without your knowledge. Please see <a href="https://emby.media/support/articles/advisory-23-05.html">https://emby.media/support/articles/advisory-23-05.html</a> for more information on how to proceed. For your safety we have shutdown your Emby Server as a precautionary measure</em> <strong>Note: Your server was never directly accessed by us. We used our standard update mechanism</strong></li>
<li>On Windows installs, you encounter an error entry in the Windows event log, <code>Source=&quot;.NET Runtime&quot;, EventId=1025</code> with the same text as above in the event details</li>
</ul>
<h2 id="background">Background</h2>
<p>Starting Mid-May 2023, a hacker managed to infiltrate private user-hosted instances of Emby Server which were accessible via public internet and had an insecure configuration for administrative user accounts. Combined with the &quot;Proxy Header Vulnerability&quot;, which was recently fixed in the beta channel, this allowed an attacker to gain administrative access on such systems.
Eventually, this allowed the attackers to install a custom plugin of their own, which establishes a backdoor in the running process of Emby Server.</p>
<p>After careful analysis and evaluation of possible strategies for mitigation, the Emby team was able to push out an update to Emby Server instances which is able to detect the plugin in question and prevents it from being loaded. Due to the severity and the nature of this situation and in an abundance of caution we are preventing affected servers to start up again after the detection. As the given situation requires direct action and assessment by the administrator, we determined that shutting down the server and preventing further startup up is the most suitable action as it disables the plug-in, possibly prevents the situation from getting worse and at the same time draws the attention of the administrator onto the subject.</p>
<p>Analysis of the plug-in has revealed that it is forwarding the private Emby Server login credentials including the password for every successful login to an external server under control of the hackers.</p>
<h2 id="actions-to-take">Actions to Take</h2>
<ul>
<li>Add an entry to your server machine etc/hosts file:
emmm.spxaebjhxtmddsri.xyz    127.0.0.1
<ul>
<li>This is the host name of the control server which the malware is communicating with</li>
<li>For help on this, please see <a href="https://linuxize.com/post/how-to-edit-your-hosts-file/">https://linuxize.com/post/how-to-edit-your-hosts-file/</a></li>
</ul>
</li>
</ul>
<p>Review your server machine for:</p>
<ul>
<li>Suspicious user accounts</li>
<li>Unknown processes</li>
<li>Unknown network connections and open ports</li>
<li>SSH configuration</li>
<li>Firewall rules</li>
<li>Change all passwords</li>
</ul>
<h2 id="starting-emby-server">Starting Emby Server</h2>
<p>After (and only after) you have done the above:</p>
<ul>
<li>Disable external network access</li>
<li>Go to the following folder under the <a href="Server-Data-Folder.html">Emby Server Data Folder</a>:
<code>plugins/configurations</code>
<ul>
<li>Find the file named <code>ReadyState.xml</code> and delete it.</li>
<li>Find the file named 'EmbyScripterX.xml' and delete it (if exists)</li>
<li>Delete the plugin .dll file(s), which comes as <code>helper.dll</code> and/or <code>EmbyHelper.dll</code>. The primary location of these is the <code>plugins</code> folder under the <a href="Server-Data-Folder.html">Emby Server Data Folder</a></li>
</ul>
</li>
<li>Start Emby Server</li>
<li>Assign new passwords to all of your <a href="Users.html">Emby Server users</a></li>
<li>Don't allow local login without password</li>
<li>Ensure no user has an empty password</li>
<li>Re-Enable public network access
<ul>
<li>Consider changing IP address, port, or DNS name  (whatever applicable)</li>
</ul>
</li>
</ul>
<div class="NOTE">
<h5>Note</h5>
<p>If possible, it would be great when you could send us the malware dll file so we can analyze to see whether different versions exist.<br>
Please send the file via private message in the forums to <a href="https://emby.media/community/index.php?/profile/20815-softworkz/">softworkz</a>.</p>
</div>
<h2 id="install-emby-server-4712-security-update">Install Emby Server 4.7.12 Security Update</h2>
<ul>
<li>Watch out for this update and install as soon as it becomes available unless you are already running Emby beta 4.8.0.31+ which also has the necessary fixes</li>
</ul>


            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix sdkversion" id="affix">
                <h5>On this Page</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to Top</a>
            </span>
            2023 © EMBY LLC.  Please see our <a class="lnk" href="https://emby.media/terms.html">terms of use</a> and <a class="lnk" href="https://emby.media/privacy.html">privacy policy</a>.
      
          <span class="contribution">
                <a href="https://github.com/EmbySupport/Emby.Docs/issues/new?title=&amp;body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23%23%23%23%20Article%20Details%0A%0A**Do%20not%20remove%20this%20section**%0A%0A*%20uid%3A%20Emby-Server-does-not-start---Security-advisory-2023-05-25%0A*%20Title%3A%20Emby%20Server%20does%20not%20start%20-%20Security%20advisory%202023-05-25%0A*%20Article%3A%20https%3A%2F%2Fgithub.com%2FEmbySupport%2FEmby.Docs%2Fblob%2Fmaster%2Fadvisory-23-05.md%0A*%20LegacyUrl%3A%20https%3A%2F%2Fsupport.emby.mediaundefined%0A" class="contribution-link" title="Feedback on this article"><div class="far fa-comment-alt fa-sm"></div></a>
                <a href="https://github.com/EmbySupport/Emby.Docs/blob/master/advisory-23-05.md/#L1" class="contribution-link " title="View article source"><div class="far fa-edit fa-sm"></div></a>
          </span>
      
          
        
      </div></div></footer>
    
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../searchIndex.js"></script>
    <script type="text/javascript" src="../styles/lunr.min.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </div></body>
</html>
