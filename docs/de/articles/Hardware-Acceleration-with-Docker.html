<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>VA API in Docker | Emby Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="VA API in Docker | Emby Documentation ">
    <meta name="generator" content="docfx 2.59.2.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <link rel="stylesheet" href="../../styles/socialbar.css">
    <link rel="stylesheet" href="../../styles/header.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,100italic,300italic,400italic" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.2.0/css/all.min.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    <meta property="docfx:uid" content="">
    <meta name="searchOption" content="noindex">
    <meta property="docfx:rel" content="../../">
    
    <script type="text/javascript" src="../../nav.js"></script>
    <script type="text/javascript" src="toc.js"></script>
  
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <div class="mb-socials-heading" style="height: 40px;">
        	<div class="mb-socials-heading-inner container">
        		<div class="mb-socials-heading-right">
        			<div class="mb-socials-list">
                          
        				<div class="mb-socials-item facebook">
        					<a class="mb-socials-item-link" target="_blank" href="https://facebook.com/embyapp"></a>
        					<div class="mb-socials-item-popup">
        						<span>Facebook</span>
        					</div>
        				</div><div class="mb-socials-item twitter">
        					<a class="mb-socials-item-link" target="_blank" href="https://twitter.com/embyapp"></a>
        					<div class="mb-socials-item-popup">
        						<span>Twitter</span>
        					</div>
        				</div>
        				<div class="mb-socials-item pinterest">
        					<a class="mb-socials-item-link" target="_blank" href="https://www.pinterest.com/emby0240/emby-news/"></a>
        					<div class="mb-socials-item-popup">
        						<span>Pinterest</span>
        					</div>
        				</div>
        				<div class="mb-socials-item tumblr">
        					<a class="mb-socials-item-link" target="_blank" href="https://embyapp.tumblr.com/"></a>
        					<div class="mb-socials-item-popup">
        						<span>Tumblr</span>
        					</div>
        				</div>
        				<div class="mb-socials-item github">
        					<a class="mb-socials-item-link" target="_blank" href="https://github.com/MediaBrowser"></a>
        					<div class="mb-socials-item-popup">
        						<span>GitHub</span>
        					</div>
        				</div><div class="mb-socials-item rss">
        					<a class="mb-socials-item-link" target="_blank" href="https://emby.media/blog.xml"></a>
        					<div class="mb-socials-item-popup">
        						<span>RSS</span>
        					</div>
        				</div>
                          
        			</div>
        		</div>
        	</div>
        </div>
        <div class="container">
        	<nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
        		  
        		  <a class="navbar-brand" href="/">
        		    <img id="logo" class="svg" src="../../images/logo.png" alt="">
        		  </a>
        		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
        			<span class="sr-only">Toggle navigation</span>
        			<span class="icon-bar"></span>
        			<span class="icon-bar"></span>
        			<span class="icon-bar"></span>
        		  </button>
        		<div class="collapse navbar-collapse" id="navbar">
        			
        			<ul class="nav level1 navbar-nav">
        			      <li class="nav-item">
        			          <a class="nav-link" href="https://emby.media/about.html" title="About">About</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="https://emby.media/blog.html" title="Blog">Blog</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="https://emby.media/download.html" title="Download">Download</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="https://emby.media/premiere.html" title="Emby Premiere">Emby Premiere</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="http://app.emby.media/" title="Sign In">Sign In</a>
        			      </li>
        			      <li class="nav-item">
        			          <a class="nav-link" href="../../index.html" title="Support">Support</a>
        			      </li>
        			</ul>		</div>
        	</nav>
        </div>
        <div class="nav-overlay d-none"></div>        
        <div class="subnav navbar navbar-default">
          <div class="container">
            <div class="hide-when-search" id="breadcrumb">
        	  <ul class="breadcrumb">
        		<li></li>
        	  </ul>
        	</div>
        
        	<div class="breadcrumpsearch">
        	  <form class="navbar-form navbar-right" role="search" id="search">
        		<div class="form-group">
        		  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
        		</div>
        	  </form>
        	</div>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1>VA API in Docker</h1>

<pre><code class="lang-yaml">title: Hardware-Beschleunigung mit Docker
longTitle: Hardware-Beschleunigung mit Docker: VA API und NVIDIA
</code></pre>
<h3 id="va-api-in-docker">VA API in Docker</h3>
<p>Verwendung von Docker auf Unraid als Beispiel</p>
<pre><code>\flash\config\go

# Modul für iGPU aktivieren und Berechtigungen für das Render-Gerät vergeben
modprobe i915
chown -R nobody:users /dev/dri
chmod -R 777 /dev/dri

Zusätzlicher Parameter für den docker run Befehl

--device /dev/dri:/dev/dri/dri:/dev/dri`
</code></pre>
<p>das war's</p>
<hr>
<p>Ich kann hier nur für Intel sprechen, aber bei den letzten 3 Generationen i6, i7, i8 ... ist alles, was für den Endverbraucher wichtig ist, vorhanden ...
Intel auf dem Host über die go-Datei aktivieren, dem Docker Zugang gewähren ... entweder über den zusätzlichen Parameter im docker run oder durch privilegierten Zugang.
Das ist alles, um alle Funktionen mit vaapi zu nutzen, alle Formate von der Seite zu dekodieren, nach h264 zu kodieren.
QuickSync ... eine andere Geschichte, die ich nicht wirklich kenne (nicht erforderlich hier, da vaapi die Arbeit erledigt).
Soweit ich mich erinnere, sind bei den meisten NAS-Systemen auf Intel-Basis wie freenas, unraid, usw. keine speziellen Treiber erforderlich ...
auch die Boxen wie Synology usw. sind sofort einsatzbereit.</p>
<p>AMD oder Nvidia sind eher anders, da es immer irgendwo ein Treiberproblem gibt ... ich habe auch versucht, Nvidia mit meinem Plex Docker zum Laufen zu bringen
und bin am Ende zu einem Wechsel gekommen (Intel für den Host nehmen und für Docker verwenden, Nvidia für meine VM durchreichen).</p>
<p>Letztendlich sind es die beiden oben genannten Schritte ... Vielleicht kann jemand mit einer Synology oder so berichten, ob es nicht einfach nur ein Klick in der Web-UI ist ...</p>
<hr>
<h3 id="nvidia-in-docker">NVIDIA in Docker</h3>
<h4 id="getestet-mit-p2000-auf-debian-9-stretch">Getestet mit P2000 auf Debian 9 (stretch)</h4>
<ul>
<li><p>Nvidia-Treiber installieren</p>
<ul>
<li><a href="https://www.nvidia.com/Download/driverResults.aspx/140135/en-us">https://www.nvidia.com/Download/driverResults.aspx/140135/en-us</a> für die neuesten</li>
<li>Um Treiber zu testen, <code>nvidia-smi</code> ausführen
<ul>
<li>Erwünschte Ausgabe:</li>
</ul>
<pre><code>&gt; nvidia-smi
$Datum
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 410.66       Driver Version: 410.66       CUDA Version: 10.0     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Quadro P2000        Off  | 00000000:83:00.0 Off |                  N/A |
| 68%   40C    P0    19W /  75W |      0MiB /  5059MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+

</code></pre>
</li>
</ul>
</li>
<li><p><code>nvidia-docker2</code> installieren</p>
<ul>
<li><a href="https://github.com/NVIDIA/nvidia-docker">https://github.com/NVIDIA/nvidia-docker</a></li>
</ul>
</li>
<li><p>Entweder Docker-Daemon bearbeiten oder Laufzeit-Argument setzen</p>
<ul>
<li>Mein Docker-Daemon: <code>/etc/docker/daemon.json</code></li>
</ul>
<pre><code>&quot;runtimes&quot;: {
    &quot;nvidia&quot;: {
        &quot;path&quot;: &quot;nvidia-container-runtime&quot;,
        &quot;runtimeArgs&quot;: []
    }
},
    &quot;default-runtime&quot;: &quot;nvidia&quot;
}
</code></pre>
</li>
<li><p>Erforderliche Docker-Umgebungsvariablen</p>
<ul>
<li>NVIDIA_VISIBLE_DEVICES=all</li>
<li>NVIDIA_DRIVER_CAPABILITIES=compute,utility,video</li>
</ul>
</li>
</ul>
<h4 id="weiterführende-literatur">Weiterführende Literatur</h4>
<p><a href="https://www.funkypenguin.co.nz/note/gpu-transcoding-with-emby-plex-using-docker-nvidia">Transkodierung mit Nvidia in Docker</a></p>


            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix sdkversion" id="affix">
                <h5>On this Page</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to Top</a>
            </span>
            2025 © EMBY LLC.  Please see our <a class="lnk" href="https://emby.media/terms.html">terms of use</a> and <a class="lnk" href="https://emby.media/privacy.html">privacy policy</a>.
      
          <span class="contribution">
                <a href="https://github.com/EmbySupport/Emby.Docs/issues/new?title=&amp;body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23%23%23%23%20Article%20Details%0A%0A**Do%20not%20remove%20this%20section**%0A%0A*%20uid%3A%20undefined%0A*%20Title%3A%20VA%20API%20in%20Docker%0A*%20Article%3A%20https%3A%2F%2Fgithub.com%2FEmbySupport%2FEmby.SupportWeb%2Fblob%2Fmaster%2FEmby.SupportWeb%2Fcontent%2Fsupport%2Fde%2Farticles%2FHardware-Acceleration-with-Docker.md%0A*%20LegacyUrl%3A%20https%3A%2F%2Fsupport.emby.mediaundefined%0A" class="contribution-link" title="Feedback on this article"><div class="far fa-comment-alt fa-sm"></div></a>
                <a href="https://github.com/EmbySupport/Emby.SupportWeb/blob/master/Emby.SupportWeb/content/support/de/articles/Hardware-Acceleration-with-Docker.md/#L1" class="contribution-link " title="View article source"><div class="far fa-edit fa-sm"></div></a>
          </span>
      
          
        
      </div></div></footer>
    
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../searchIndex.js"></script>
    <script type="text/javascript" src="../../styles/lunr.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </div></body>
</html>
